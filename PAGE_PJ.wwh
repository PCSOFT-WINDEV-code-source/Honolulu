#To edit and compare internal_properties, use WINDEV integrated tools.
#Internal properties refer to the properties of controls in windows, reports, etc.
info :
 name : PAGE_PJ
 major_version : 28
 minor_version : 0
 type : 65538
 description : Récupération des pièces jointes
 subtype : 8192
page :
 name : PAGE_PJ
 identifier : 0x25533c3202b6c675
 internal_properties : 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
 properties : {}
 type : 1
 languages :
  - fr-FR
 code_elements :
  type_code : 38
  p_codes :
   -
     internal_properties : CAAAAAgAAAAdPYMKfm7gVCf3p+GDl5JK/smAQteym/Z/QPpXVzmokhkTi5m4dkmMQlwKAgVLAbdbrEwdKlV2Uz3UqLC/sPzgYgyKdn38CcIbxAKn30Gk+jhlcPBDQX4d75z0WK1raiqiLFk21a/Cn99KejaN2Ho8OWdPgRwRMi7/0NWI5/AhYJ3fv0Gq6G1CiQv54ZvSMvE=
     code : |1-
      
      //dbgactiveAssertion(vrai)
      
      quand exception
      	exceptionactive()
      	ChaîneAffiche(exceptioninfo(), "text/plain")
      	retour
      FIN
      
      local
      	bufMémo est un buffer
      	sClé est une chaine
      	sTypeMIME est une chaine
      	sNomFichier est une chaine
      	nTailleFichier est un entier
      	oImage est une image
      
      	// Récupère la clé	
      	sClé = PageParamètre("cle")
      
      	si sClé <> "" alors		
      		
      		// Récupère la pièce jointe
      		bufMémo = PJRécupère(sClé, "", sTypeMIME, nTailleFichier, sNomFichier)
      		dbgAssertion(bufMémo <> "")
      		
      		si PageParamètre("mode") = "homo" alors
      			
      			// Charge
      			oImage = bufMémo
      			oImage..CouleurRemplissage = blanc
      			
      			// On doit redimensionner l'image
      			dRedimensionne(oImage, val(PageParamètre("sizel")), val(PageParamètre("sizeh")), drHomothétique + drHauteQualité)
      			
      			// Renvoie l'image retaillée
      			ChaîneAffiche(dSauveImageJPEG(oImage, enMémoire), "image/jpeg")
      		sinon
      			SI bufMémo <> "" ALORS
      				ChaîneAffiche(bufMémo, sTypeMIME, sNomFichier)
      			SINON
      				// On ne renvoie rien si on n'a rien trouvé
      				ChaîneAffiche(<§$0001§>, "text/plain")		
      			FIN	
      		FIN
      	sinon
      		
      		si PageParamètre("mime") <> "" ALORS
      
      			// Charge l'image
      			oImage = IconeTypeMIME(PageParamètre("mime"), faux)
      			oImage..CouleurRemplissage = Blanc
      		
      			// On doit redimensionner l'image
      			dRedimensionne(oImage, Val(PageParamètre("sizel")), Val(PageParamètre("sizeh")), drHomothétique + drHauteQualité)
      			
      			// Renvoie l'image retaillée
      			ChaîneAffiche(dSauveImageJPEG(oImage, enMémoire), "image/jpeg")
      		sinon
      			
      			si PageParamètre("ban") <> "" alors
      				
      				// Charge la bannière
      				oImage = dchargeimage(ComplèteRep(fRepWeb()) + "ext\bannieres\" + PageParamètre("ban"))				
      				oImage..CouleurRemplissage = RVB(248, 248, 248)
      				
      				// On doit redimensionner l'image
      				dRedimensionne(oImage, 225, 45, drHomothétique + drHauteQualité)
      				
      				// Renvoie l'image retaillée
      				ChaîneAffiche(dSauveImageJPEG(oImage, enMémoire), "image/jpeg")
      			sinon
      				// On ne renvoie rien si on n'a rien trouvé
      				ChaîneAffiche(<§$0000§>, "text/plain")					
      			FIN
      		FIN
      		
      	FIN
      	
     type : 851968
   -
     type : 852017
     enabled : false
   -
     type : 852119
     enabled : false
   -
     type : 852298
     role : N
   -
     type : 851999
     role : N
   -
     type : 852000
     role : N
   -
     type : 852232
     enabled : false
   -
     type : 852167
     enabled : false
   -
     type : 852169
     role : N
     enabled : false
   -
     type : 852225
     role : N
     enabled : false
   -
     type : 852227
     enabled : false
   -
     type : 1310979
     enabled : false
   -
     type : 852228
     role : N
     enabled : false
   -
     type : 852217
     role : N
     enabled : false
 code_parameters :
  internal_properties : CAAAAAgAAACVGQgYbalU7DKC3oH4ItDrjtcTHXXV/EuH8q0IbhyQlw==
  original_name : PAGE_Page1
resources :
 string_res :
  identifier : 0x15533c21007a83de
  internal_properties : CAAAAAgAAACm76HWfKGWp33VjXInA4cRlqArlgTTA862QGt72W2ld5Y=
  strings :
   -
     text :
      fr-FR : Aucune pièce jointe
     index : 0
   -
     text :
      fr-FR : La pièce jointe est introuvable
     index : 1
webification :
 internal_properties : CAAAAAgAAACYzxT95H3qP7nIys4LqA==
custom_note :
 internal_properties : CAAAAAgAAAC68/W0/adbG0nFCRhrE42B5HRnbDzVHaz86sSQyxlBk7I=
rad :
 internal_properties : CAAAAAgAAABoAN7PLpwJW3EiA7WVZdCA5EwrCA1rvutcDHooMWKe
